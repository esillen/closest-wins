<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Players - Closest Wins</title>
	<link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
	<nav>
		<ul>
			<li><a href="/play">Play</a></li>
			<li><a href="/spectate">Spectate</a></li>
			<li><a href="/join">Join</a></li>
			<li th:if="${isAdmin}"><a href="/players">Players</a></li>
			<li><a href="/admin">Admin</a></li>
		</ul>
	</nav>
	
	<main>
		<div class="content medium">
			<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
				<h1>Players</h1>
				<a href="/admin" class="admin-button">â† Back to Admin</a>
			</div>
			<div th:if="${success}" class="success-message" th:text="${success}"></div>
			<div th:if="${error}" class="error-message" th:text="${error}"></div>
			<div th:if="${players == null or players.isEmpty()}" class="no-players">
				<div class="no-players-icon">ğŸ‘¥</div>
				<p>No players yet. Be the first to <a href="/join">join</a>!</p>
			</div>
			<div th:if="${players != null and !players.isEmpty()}" class="players-list">
				<div th:each="player : ${players}" class="player-card" th:style="'border-left-color: ' + ${player.color}">
					<div class="player-emoji" th:text="${player.emoji}"></div>
					<div class="player-info">
						<div class="player-name" th:text="${player.name}"></div>
						<div class="player-id" th:text="'ID: ' + ${player.id}"></div>
						<div class="player-score" th:text="'Score: ' + ${player.score}"></div>
						<div th:if="${player.currentGuess != null}" class="player-guess has-guess">
							ğŸ“ Guess: <span th:text="${#numbers.formatDecimal(player.currentGuess.latitude, 1, 6)}"></span>, 
							<span th:text="${#numbers.formatDecimal(player.currentGuess.longitude, 1, 6)}"></span>
						</div>
						<div th:if="${player.currentGuess == null}" class="player-guess">
							No guess yet
						</div>
					</div>
					<div class="player-actions" th:if="${isAdmin}">
						<form method="post" action="/players/assume" style="display: inline-block;">
							<input type="hidden" name="playerId" th:value="${player.id}">
							<button type="submit" class="assume-button">Assume this player</button>
						</form>
						<form method="post" action="/players/delete" style="display: inline-block; margin-left: 0.5rem;" 
							  onsubmit="return confirm('Are you sure you want to delete this player?');">
							<input type="hidden" name="playerId" th:value="${player.id}">
							<button type="submit" class="admin-button danger">Delete</button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</main>
</body>
</html>

